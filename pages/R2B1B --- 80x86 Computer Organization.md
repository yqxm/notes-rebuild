- #+BEGIN_PINNED
  Carter, P. A. (2003). PC Assembly Language. Self-published.p4-10
  #+END_PINNED
- ## 内存
	- 最基本的内存单元是**字节**，每一个字节都有一个独一无二的地址。
	- 存储在内存中的所有数据都是数字(numeric)的。字符通过编码从数字映射到字符。最为人所知的编码是ASCII编码，仅占据1个字节。它的扩展是Unicode编码，占据2个字节。
- ## CPU
	- CPU是一个执行指令的设备，从它自身的一个叫作寄存器的特殊存储器来获取指令。从寄存器获取数据比从内存获取数据要块得多，但寄存器的大小和数量都是有限的。
	- CPU执行的指令构成了CPU的机器语言。因为它的设计目标是为了让CPU更快的执行指令，所以机器语言的指令就全是数字，难以阅读。通常来说，不同的CPU都有它自身的机器语言。
	- CPU使用*clock(时钟)*来同步指令的执行。*clock*并不跟踪分或秒，它只是按照固定频率振动。CPU使用这种振动来正确的执行指令，就行乐器跟着节拍器演奏一样。一条指令的振动次数，或者更常用的说法“时钟周期”，需要看CPU是第几代和它的模型。
- ## 80x86 CPU
	- **8088，8086**:
		- 最早的CPU，提供了几个16位寄存器。它们只支持1M的内存并且只能在*real mode*使用。在这个模式下，程序可以访问任何地址。这对debug和security非常不利。并且如果程序太大的话，程序需要被分片，每一片不能大于64Kb。
		- **寄存器**: `AX BX CX DX SI DI BP SP CS DS SS ES IP FLAGS`
	- **80286**:
		- IBM PC-AT上的CPU。它给`8086`的机器语言增加了一些指令，但最重要的一个特性是添加了*16-bit protected mode*。这让程序不能随便访问其他程序的内存。但程序片最大还是只有64Kb。
	- **80386**:
		- 80286的加强版。将寄存器扩展到能存储32位的数据，增加了两个寄存器`FS`和`GS`，增加了*32-bit protected mode*。在这个模式下，可以访问4GB的内存地址，程序还是被分成片，但一片的最大大小变成了4g。
	- **80486/Pentium/Pentium Pro**:
		- 几乎没有增加新特性，加快了执行速度。
	- **Pentium MMX**:
		- 增加`MMX`扩展，加快图像处理的能力。
	- **Pentium II**:
		- Pentium Pro和MMX的结合。
- ## 8086 16-bit 寄存器
	- 通用寄存器:
		- `AX BX CX DX`，一般用于数据传送指令和计算指令。
	- Index寄存器:
		- `SI DI`，经常作为指针，但也可以当通用寄存器来用，不过不能像通用寄存器那样分成两个8位寄存器。
	- `BP SP`寄存器指向栈。
	- Segment寄存器:
		- `CS DS SS ES`，指示内存是如何被程序的不同部分使用的。`CS`是指code segment， `DS`是指data segment，`SS`是指stack segment，`ES`是指extra segment。`ES`被用作临时segment寄存器 。
	- 指令寄存器:
		- `IP`和`CS`寄存器一起使用来跟踪CPU执行的下一条指令的地址。通常指令被执行的时候，`ip`已经先指向下一条指令了。
	- `FLAGS`寄存器保存前一条指令的结果信息。
- ## 80386 32-bit 寄存器
	- 80386将8086的寄存器扩展到32位，寄存器名称前面加`E`表示时扩展。
	- segment寄存器还是16位。
	- 新的寄存器`FS GS`的名称没有特别的意义，它们作为临时寄存器被添加，和`ES`一样。
- ## Real Mode
	- *地址访问*
		- 在*Real mode*下，内存只能访问1m($2^{20}$)的地址空间。合法的地址范围从`00000`到`FFFFF`。这个地址要求一个20位的地址，而16位的寄存器明显是不够的。所以`Intel`使用两个寄存器来代表一个地址，
			- 第一个16位的值是*selector*，必须存放在*segment*寄存器中。
			- 第二个16位的值是*offset*。
		- 整个地址可以用`selector:offset`来表示，使用$16 * \text{selector} + \text{offset}$表示。效果上，*selector*的值相当于*paragraph*的标号。
	- *缺点*
		- 一个`selector`只能访问64K的内存。如果一个程序的大小大于64K，一个`CS`寄存器的值就不能指示整个程序的执行，程序就必须分成几个块。当程序从这个块到下一个块时，`CS`的值必须发生改变。
		- 内存中的每一个字节的地址不是唯一表示的，比如地址`04808`可以用`047C:0048`或`047D:0038`表示。
- ## 16-bit Protected Mode
	- 在*protected mode*下，*selector*的值不代表*paragraph*的标号，而是*descriptor table*的一个索引。利用虚拟内存的技术，*segment*在内存和磁盘间移动，操作系统管理*segment*的*entry*。程序不需要关心*segment*的具体位置
	- *缺点*
		- *paragraph*的大小还是限制在64K
- ## 32-bit Protected Mode
	- 80386引入了*32-bit protected mode*。它和286的`16-bit protected mode`的最大区别是:
		- *Offset*扩展到了32位。
		- *segment*可以被分割成4K大小的单元，叫作“页”。虚拟内存与页打交道而不是*paragraph*。
- ## Interrupts
	- 有时程序的执行流会被需要即时反馈的进程事件中断，比如鼠标移动会中断当前程序，并在鼠标移动完成后返回到被中断的程序，让程序继续执行。
	- 中断由中断处理器的例行程序处理，每个中断都有它的编号。在内存最开始处，中断向量表所在的地方包含了中断处理器的分段内存地址。中断的编号就是这张表的索引。
-